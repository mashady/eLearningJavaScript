<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses</title>
</head>
<body>
    <h1>Courses</h1>
    <div id="courses-list">
    </div>

    <!-- <script>
        // function enrollCourse(courseName) {
        //     let user = JSON.parse(localStorage.getItem("currentUser"));

        //     if (!user) {
        //         alert("You must be logged in to enroll in a course!");
        //         return; 
        //     }

        //     let enrollRequest = {
        //         username: user.username,
        //         course: courseName,
        //         status: "pending" // حالة الطلب
        //     };

        //     let enrollRequests = JSON.parse(localStorage.getItem("enrollRequests")) || [];
        //     enrollRequests.push(enrollRequest);
        //     localStorage.setItem("enrollRequests", JSON.stringify(enrollRequests));

        //     alert("Enroll request sent to admin!");
        // }
    // let enrollRequests = []; // مصفوفة لتخزين الطلبات مؤقتًا

    // function enrollCourse(courseName) {
    //     let user = { username: "test_user" }; // مستخدم ثابت لتجربة الكود

    //     let enrollRequest = {
    //         username: user.username,
    //         course: courseName,
    //         status: "pending"
    //     };

    //     enrollRequests.push(enrollRequest);
    //     console.log("Enroll Requests:", enrollRequests); // التحقق من الطلبات في الكونسول
    //     alert("Enroll request sent to admin!");
    // }
</script> -->
    <!-- <script>

    let user = { 
        username: "test_user", 
        enrolledCourses: [] 
    };

    function enrollCourse(courseName) {
        if (!user) {
            alert("You must be logged in to enroll in a course!");
            return; 
        }

        let enrollRequest = {
            username: user.username,
            course: courseName,
            status: "pending"
        };

        let enrollRequests = JSON.parse(localStorage.getItem("enrollRequests")) || [];
        enrollRequests.push(enrollRequest);
        localStorage.setItem("enrollRequests", JSON.stringify(enrollRequests));

        alert("Enroll request sent to admin!");
    }
</script> -->

<script>
    // الدالة لتحميل الكورسات من LocalStorage وعرضها للمستخدم
    function loadCoursesForUser() {
        let courses = JSON.parse(localStorage.getItem("courses")) || [];
        const coursesList = document.getElementById("courses-list");
        coursesList.innerHTML = "";

        if (courses.length === 0) {
            coursesList.innerHTML = "<p>No courses available</p>";
            return;
        }

        courses.forEach(course => {
            const courseItem = document.createElement("div");
            courseItem.classList.add("course-card");
            courseItem.innerHTML = `
                <h3>${course.title}</h3>
                <p><strong>Category:</strong> ${course.category}</p>
                <p><strong>Instructor:</strong> ${course.instructor}</p>
                <p><strong>Duration:</strong> ${course.duration}</p>
                <button onclick="enrollInCourse('${course.id}')">Enroll</button>
            `;
            coursesList.appendChild(courseItem);
        });
    }

    // // دالة للتسجيل في كورس
    // function enrollInCourse(courseId) {
    //     // يمكنك إضافة كود لتخزين تسجيلات المستخدم في LocalStorage هنا
    //     let userEnrollments = JSON.parse(localStorage.getItem("userEnrollments")) || [];
        
    //     if (userEnrollments.some(enrollment => enrollment.courseId === courseId)) {
    //         alert("You are already enrolled in this course!");
    //         return;
    //     }

    //     // إضافة تسجيل الكورس للمستخدم
    //     userEnrollments.push({ courseId });
    //     localStorage.setItem("userEnrollments", JSON.stringify(userEnrollments));
        
    //     alert("Successfully enrolled in the course!");
    // }

    // // تحميل الكورسات عند تحميل الصفحة
    // document.addEventListener("DOMContentLoaded", function() {
    //     loadCoursesForUser();  // تحميل الكورسات من LocalStorage وعرضها للمستخدم
    // });
    // دالة للتسجيل في كورس مع إرسال الطلب للأدمن

    function enrollInCourse(courseId) {
    let user = { username: "test_user" };  
    let enrollRequests = JSON.parse(localStorage.getItem("enrollRequests")) || [];

    if (enrollRequests.some(request => request.courseId === courseId && request.username === user.username)) {
        alert("You have already sent an enrollment request for this course!");
        return;
    }

    const enrollRequest = {
        username: user.username,
        courseId: courseId,
        status: "pending"  
    };
    console.log(enrollRequests)
    enrollRequests.push(enrollRequest);
    localStorage.setItem("enrollRequests", JSON.stringify(enrollRequests));
    
    alert("Your enrollment request has been sent to the admin!");
}
 document.addEventListener("DOMContentLoaded", function() {
        loadCoursesForUser();  
    });

</script>
    
</body>
</html>